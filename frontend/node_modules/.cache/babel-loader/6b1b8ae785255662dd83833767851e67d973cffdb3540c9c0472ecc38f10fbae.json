{"ast":null,"code":"import{createContext,useEffect}from\"react\";import{useState}from\"react\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";export const StoreContext=/*#__PURE__*/createContext(null);const StoreContextProvider=props=>{const url=\"http://localhost:4000\";const[token,setToken]=useState(\"\");const[food_list,setFoodlist]=useState([]);const[cartItems,setCartItems]=useState({});const addToCart=async itemId=>{if(!cartItems[itemId]){setCartItems(prev=>({...prev,[itemId]:1}));}else{setCartItems(prev=>({...prev,[itemId]:prev[itemId]+1}));}if(token){await axios.post(`${url}/api/cart/add`,{itemId},{headers:{token}});}};const removeFromCart=async itemId=>{setCartItems(prev=>({...prev,[itemId]:prev[itemId]-1}));if(token){await axios.post(`${url}/api/cart/remove`,{itemId},{headers:{token}});}};const getTotalCartAmount=()=>{let totalAmount=0;for(const item in cartItems){if(cartItems[item]>0){let itemInfo=food_list.find(product=>{return product._id===item;});totalAmount+=itemInfo.price*cartItems[item];}}return totalAmount;};const loadCartData=async token=>{try{const response=await axios.post(`${url}/api/cart/get`,{},{headers:{token}});if(response.data&&response.data.cartData){setCartItems(response.data.cartData);}else{console.error(\"Invalid response format:\",response);}}catch(error){console.error(\"Error loading cart data:\",error);}};const fetchFoodList=async()=>{try{const response=await axios.get(url+\"/api/food/list\");setFoodlist(response.data.data);}catch(error){console.log(error);}};useEffect(()=>{async function loadData(){await fetchFoodList();if(localStorage.getItem(\"token\")){setToken(localStorage.getItem(\"token\"));await loadCartData(localStorage.getItem(\"token\"));}}loadData();},[]);const contextValue={food_list,cartItems,setCartItems,addToCart,removeFromCart,getTotalCartAmount,url,token,setToken};return/*#__PURE__*/_jsx(StoreContext.Provider,{value:contextValue,children:props.children});};export default StoreContextProvider;","map":{"version":3,"names":["createContext","useEffect","useState","axios","jsx","_jsx","StoreContext","StoreContextProvider","props","url","token","setToken","food_list","setFoodlist","cartItems","setCartItems","addToCart","itemId","prev","post","headers","removeFromCart","getTotalCartAmount","totalAmount","item","itemInfo","find","product","_id","price","loadCartData","response","data","cartData","console","error","fetchFoodList","get","log","loadData","localStorage","getItem","contextValue","Provider","value","children"],"sources":["C:/Users/bpenchalaiah/Desktop/food app/frontend/src/context/Storecontext.jsx"],"sourcesContent":["import { createContext, useEffect } from \"react\";\r\nimport { useState } from \"react\";\r\nimport axios from \"axios\";\r\nexport const StoreContext=createContext(null);\r\nconst StoreContextProvider=(props)=>{\r\n    const url=\"http://localhost:4000\";\r\n    const [token,setToken]=useState(\"\");\r\n    const [food_list,setFoodlist]=useState([]);\r\n    const [cartItems,setCartItems]=useState({});\r\n    const addToCart=async (itemId)=>{\r\n        if(!cartItems[itemId]){\r\n            setCartItems((prev)=>({...prev,[itemId]:1}))\r\n        }\r\n        else{\r\n            setCartItems((prev)=>({...prev,[itemId]:prev[itemId]+1}))\r\n        }\r\n        if(token){\r\n            await axios.post(`${url}/api/cart/add`,{itemId},{headers:{token}})\r\n        }\r\n    }\r\n    const removeFromCart=async (itemId)=>{\r\n        setCartItems((prev)=>({...prev,[itemId]:prev[itemId]-1}))\r\n        if(token){\r\n            await axios.post(`${url}/api/cart/remove`,{itemId},{headers:{token}})\r\n        }\r\n    }\r\n    \r\n    const getTotalCartAmount=()=>{\r\n        let totalAmount=0;\r\n        for(const item in cartItems){\r\n            if(cartItems[item]>0){\r\n                let itemInfo=food_list.find((product)=>{\r\n                return product._id===item\r\n           })\r\n           totalAmount+=itemInfo.price*cartItems[item];}\r\n            \r\n        }\r\n        return totalAmount;\r\n    }\r\n   \r\n    const loadCartData = async (token) => {\r\n        try {\r\n            const response = await axios.post(`${url}/api/cart/get`, {}, { headers: { token } });\r\n            if (response.data && response.data.cartData) {\r\n                setCartItems(response.data.cartData);\r\n            } else {\r\n                console.error(\"Invalid response format:\", response);\r\n                \r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error loading cart data:\", error);\r\n           \r\n        }\r\n    };\r\n    const fetchFoodList=async ()=>{\r\n        try{\r\n            const response=await axios.get(url+\"/api/food/list\")\r\n        setFoodlist(response.data.data)\r\n        }\r\n        catch(error){\r\n            console.log(error)\r\n        }\r\n        \r\n}\r\n    useEffect(()=>{\r\n        async function loadData(){\r\n            await fetchFoodList();\r\n            if(localStorage.getItem(\"token\")){\r\n                setToken(localStorage.getItem(\"token\"))\r\n                await loadCartData(localStorage.getItem(\"token\"));\r\n            }\r\n        }\r\n        loadData();\r\n    },[])\r\n    const contextValue={\r\n            food_list,\r\n            cartItems,\r\n            setCartItems,\r\n            addToCart,\r\n            removeFromCart,\r\n            getTotalCartAmount,\r\n            url,\r\n            token,\r\n            setToken\r\n    }\r\n    return(\r\n        <StoreContext.Provider value={contextValue}>\r\n            {props.children}\r\n        </StoreContext.Provider>\r\n    );\r\n}\r\nexport default StoreContextProvider;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}