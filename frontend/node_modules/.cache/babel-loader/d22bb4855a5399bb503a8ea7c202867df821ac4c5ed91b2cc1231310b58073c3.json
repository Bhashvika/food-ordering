{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import'./Placeorder.css';import{StoreContext}from'../../context/Storecontext';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Placeorder=()=>{const navigate=useNavigate();const{getTotalCartAmount,token,food_list,cartItems,url}=useContext(StoreContext);const[data,setData]=useState({firstName:\"\",lastName:\"\",email:\"\",street:\"\",city:\"\",state:\"\",zipcode:\"\",country:\"\",phone:\"\"});const onChangeHandler=event=>{const name=event.target.name;const value=event.target.value;setData(data=>({...data,[name]:value}));};useEffect(()=>{if(!token||getTotalCartAmount()===0){navigate('/cartpage');}},[token,getTotalCartAmount,navigate]);const placeorder=async event=>{event.preventDefault();let orderItems=[];food_list.forEach(item=>{if(cartItems[item._id]>0){let iteminfo={...item,quantity:cartItems[item._id]};orderItems.push(iteminfo);}});let orderData={address:data,items:orderItems,amount:getTotalCartAmount()+10};try{let response=await axios.post(url+\"/api/order/place\",orderData,{headers:{token}});console.log(\"Response data:\",response.data);if(response.data.success){const{session_url}=response.data;window.location.replace(session_url);}else{alert(\"Error: \"+response.data.message);}}catch(error){console.log(error);alert(\"Error: \"+error.message);}};return/*#__PURE__*/_jsxs(\"form\",{className:\"Placeorder\",onSubmit:placeorder,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"place-order-left\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"title\",children:\"Delivery Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"multi-fields\",children:[/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",placeholder:\"First Name\",name:\"firstName\",value:data.firstName,onChange:onChangeHandler}),/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",placeholder:\"Last Name\",name:\"lastName\",value:data.lastName,onChange:onChangeHandler})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"multi-fields\",children:[/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",placeholder:\"Email Address\",name:\"email\",value:data.email,onChange:onChangeHandler}),/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",placeholder:\"Street\",name:\"street\",value:data.street,onChange:onChangeHandler})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"multi-fields\",children:[/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",placeholder:\"City\",name:\"city\",value:data.city,onChange:onChangeHandler}),/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",placeholder:\"State\",name:\"state\",value:data.state,onChange:onChangeHandler})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"multi-fields\",children:[/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",placeholder:\"Zipcode\",name:\"zipcode\",value:data.zipcode,onChange:onChangeHandler}),/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",placeholder:\"Country\",name:\"country\",value:data.country,onChange:onChangeHandler})]}),/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",placeholder:\"Phone\",name:\"phone\",value:data.phone,onChange:onChangeHandler})]}),/*#__PURE__*/_jsx(\"div\",{className:\"place-order-right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Cart Totals\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total-details\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"SubTotal\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"$\",getTotalCartAmount()]})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total-details\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Delivery Fee\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"$\",getTotalCartAmount()===0?0:10]})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total-details\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Total\"}),/*#__PURE__*/_jsxs(\"b\",{children:[\"$\",getTotalCartAmount()===0?0:getTotalCartAmount()+10]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"PROCEED TO PAYMENT\"})]})})]});};export default Placeorder;","map":{"version":3,"names":["React","useContext","useEffect","useState","StoreContext","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Placeorder","navigate","getTotalCartAmount","token","food_list","cartItems","url","data","setData","firstName","lastName","email","street","city","state","zipcode","country","phone","onChangeHandler","event","name","target","value","placeorder","preventDefault","orderItems","forEach","item","_id","iteminfo","quantity","push","orderData","address","items","amount","response","post","headers","console","log","success","session_url","window","location","replace","alert","message","error","className","onSubmit","children","required","type","placeholder","onChange"],"sources":["C:/Users/bpenchalaiah/Desktop/food app/frontend/src/pages/placeorder/Placeorder.jsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport './Placeorder.css';\r\nimport { StoreContext } from '../../context/Storecontext';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst Placeorder = () => {\r\n  const navigate = useNavigate();\r\n  const { getTotalCartAmount, token, food_list, cartItems, url } = useContext(StoreContext);\r\n  const [data, setData] = useState({\r\n    firstName: \"\",\r\n    lastName: \"\",\r\n    email: \"\",\r\n    street: \"\",\r\n    city: \"\",\r\n    state: \"\",\r\n    zipcode: \"\",\r\n    country: \"\",\r\n    phone: \"\"\r\n  });\r\n\r\n  const onChangeHandler = (event) => {\r\n    const name = event.target.name;\r\n    const value = event.target.value;\r\n    setData(data => ({ ...data, [name]: value }));\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!token || getTotalCartAmount() === 0) {\r\n      navigate('/cartpage');\r\n    }\r\n  }, [token, getTotalCartAmount, navigate]);\r\n\r\n  const placeorder = async (event) => {\r\n    event.preventDefault();\r\n    let orderItems = [];\r\n    food_list.forEach((item) => {\r\n      if (cartItems[item._id] > 0) {\r\n        let iteminfo = { ...item, quantity: cartItems[item._id] };\r\n        orderItems.push(iteminfo);\r\n      }\r\n    });\r\n\r\n    let orderData = {\r\n      address: data,\r\n      items: orderItems,\r\n      amount: getTotalCartAmount() + 10,\r\n    };\r\n\r\n    try {\r\n      let response = await axios.post(url + \"/api/order/place\", orderData, { headers: { token } });\r\n      console.log(\"Response data:\", response.data);\r\n      if (response.data.success) {\r\n        const { session_url } = response.data;\r\n        window.location.replace(session_url);\r\n      } else {\r\n        alert(\"Error: \" + response.data.message); \r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      alert(\"Error: \" + error.message); \r\n    }\r\n  };\r\n\r\n  return (\r\n    <form className='Placeorder' onSubmit={placeorder}>\r\n      <div className=\"place-order-left\">\r\n        <p className='title'>Delivery Information</p>\r\n        <div className=\"multi-fields\">\r\n          <input required type=\"text\" placeholder='First Name' name=\"firstName\" value={data.firstName} onChange={onChangeHandler} />\r\n          <input required type=\"text\" placeholder='Last Name' name=\"lastName\" value={data.lastName} onChange={onChangeHandler} />\r\n        </div>\r\n        <div className='multi-fields'>\r\n          <input required type=\"text\" placeholder='Email Address' name=\"email\" value={data.email} onChange={onChangeHandler} />\r\n          <input required type=\"text\" placeholder='Street' name=\"street\" value={data.street} onChange={onChangeHandler} />\r\n        </div>\r\n        <div className=\"multi-fields\">\r\n          <input required type=\"text\" placeholder='City' name=\"city\" value={data.city} onChange={onChangeHandler} />\r\n          <input required type=\"text\" placeholder='State' name=\"state\" value={data.state} onChange={onChangeHandler} />\r\n        </div>\r\n        <div className=\"multi-fields\">\r\n          <input required type=\"text\" placeholder='Zipcode' name=\"zipcode\" value={data.zipcode} onChange={onChangeHandler} />\r\n          <input required type=\"text\" placeholder='Country' name=\"country\" value={data.country} onChange={onChangeHandler} />\r\n        </div>\r\n        <input required type='text' placeholder='Phone' name=\"phone\" value={data.phone} onChange={onChangeHandler} />\r\n      </div>\r\n      <div className=\"place-order-right\">\r\n        <div className=\"cart-total\">\r\n          <h2>Cart Totals</h2>\r\n          <div>\r\n            <div className=\"cart-total-details\">\r\n              <p>SubTotal</p>\r\n              <p>${getTotalCartAmount()}</p>\r\n            </div>\r\n            <hr />\r\n            <div className=\"cart-total-details\">\r\n              <p>Delivery Fee</p>\r\n              <p>${getTotalCartAmount() === 0 ? 0 : 10}</p>\r\n            </div>\r\n            <hr />\r\n            <div className=\"cart-total-details\">\r\n              <b>Total</b>\r\n              <b>${getTotalCartAmount() === 0 ? 0 : getTotalCartAmount() + 10}</b>\r\n            </div>\r\n          </div>\r\n          <button type=\"submit\">PROCEED TO PAYMENT</button>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Placeorder;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}